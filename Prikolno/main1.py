import sys

sys.path.append(r'C:\Program Files\FreeCAD 0.18\bin')
sys.path.append(r'C:\Program Files\FreeCAD 0.18\lib')

import FreeCAD as App
# import
import Part

# Создание нового документа
# exec(open('C:/Program Files/FreeCAD 0.18/data/Mod/Start/StartPage/LoadNew.py').read())
doc = App.newDocument()
App.setActiveDocument("Unnamed")
# App.ActiveDocument = App.getDocument("Unnamed")

# secheniya = range(12)

# Добавление эскиза
Sketch = doc.addObject('Sketcher::SketchObject', 'Sketch')
Sketch.Placement = App.Placement(
    App.Vector(0.000000, 0.000000, 0.0),
    App.Rotation(0.000000, 0.000000, 0.000000, 1.000000)
)
Sketch.MapMode = "Deactivated"
x_array = [ 9.170418390221927, 7.872545153755942, 6.620603360470796, 5.414593010366491, 4.254514103443025, 3.140366639700399, 2.0721506191386125, 1.049866041757668, 0.07351290755756038, -0.8569087834617045, -1.7413990313001328, -2.5799578359577198, -3.3725851974344665, -4.119281115730372, -4.820045590845439, -5.474878622779667, -6.083780211533056, -6.646750357105603, -7.163789059497309, -7.6348963187081775, -8.060072134738203, -8.439316507587392, -8.77262943725574, -9.06001092374325, -9.301460967049916, -9.496979567175746, -9.646566724120733, -9.750222437884881, -9.80794670846819, -9.819739535870658, -9.785600920092287, -9.705530861133079, -9.579529358993026, -9.407596413672136, -9.189732025170406, -8.925936193487836, -8.616208918624425, -8.260550200580175, -7.858960039355083, -7.411438434949156, -6.917985387362386, -6.378600896594776, -5.793284962646325, -5.162037585517035, -4.4848587652069085, -3.761748501715939, -2.992706795044129, -2.1777336451914793, -1.316829052157989, -0.4099930159436592, -0.4099930159436592, -0.1829126926902863, 0.032743277712735844, 0.2362065676050101, 0.426660032934181, 0.6032377132559326, 0.7650248317339888, 0.911057795140114, 1.0403241938541132, 1.1517628018638315, 1.2442635767651542, 1.3166676597620057, 1.3677673756663526, 1.3963062328982014, 1.4009789234855974, 1.3804313230646266, 1.3332604908794166, 1.2580146697821346, 1.1531932862329868, 1.0172469503002206, 1.0172469503002206, 0.6041328006387539, 0.21544983816120825, -0.14880193713241616, -0.48862252524211935, -0.8040119261679014, -1.0949701399097604, -1.3614971664677002, -1.6035930058417192, -1.821257658031816, -2.0144911230379927, -2.1832934008602467, -2.327664491498581, -2.4476043949529926, -2.5431131112234846, -2.614190640310055, -2.6608369822127043, -2.683052136931432, -2.6808361044662394, -2.6541888848171244, -2.6031104779840892, -2.527600883967132, -2.427660102766255, -2.3032881343814564, -2.1544849788127367, -1.9812506360600948, -1.7835851061235333, -1.5614883890030484, -1.3149604846986456, -1.0440013932103194, -0.7486111145380726, -0.4287896486819046, -0.08453699564181547, 0.28414684458219475, 0.6772618719901266, 1.0948080865819778, 1.5367854883577519, 2.0031940773174455, 2.494033853461062, 3.0093048167885983, 3.5490069673000577, 4.113140304995438, 4.701704829874739, 5.314700541937958, 5.952127441185102, 6.613985527616165, 7.3002748012311525, 8.010995262030058, 8.746146910012884, 9.505729745179632, 9.505729745179632, 9.55206234201923, 9.58901975057461, 9.616856154716292, 9.635862173384751, 9.646364860590419, 9.648727705413679, 9.643350632004886, 9.630669999584361, 9.611158602442362, 9.58532566993912, 9.553716866504832, 9.516914291639639, 9.475536479913648, 9.43023840096693, 9.381711459509509, 9.330683495321376, 9.277918783252469, 9.2242180332227, 9.170418390221927 ]
y_array = [ -15.270642744160815, -14.449685596723127, -13.637517721804661, -12.834139119405416, -12.039549789525386, -11.253749732164573, -10.476738947322984, -9.708517435000617, -8.949085195197467, -8.198442227913537, -7.456588533148823, -6.723524110903329, -5.999248961177058, -5.2837630839700065, -4.577066479282172, -3.8791591471135636, -3.190041087464172, -2.5097123003339927, -1.838172785723037, -1.175422543631301, -0.5214615740587867, 0.12371012299451145, 0.7600925475285845, 1.387685699543443, 2.006489579039078, 2.616504186015499, 3.217729520472693, 3.810165582410672, 4.393812371829432, 4.9686698887289715, 5.53473813310929, 6.09201710497039, 6.640506804312272, 7.180207231134933, 7.711118385438376, 8.233240267222596, 8.746572876487598, 9.25111621323338, 9.746870277459946, 10.233835069167288, 10.712010588355412, 11.181396835024316, 11.641993809174004, 12.093801510804468, 12.536819939915713, 12.97104909650774, 13.396488980580546, 13.813139592134133, 14.221000931168502, 14.62007299768365, 14.62007299768365, 14.70356366087439, 14.757824935005663, 14.784645208059402, 14.785774728472171, 14.762925605135155, 14.717771807394163, 14.65194916504963, 14.567055368356609, 14.464649968024785, 14.346254375218463, 14.21335186155657, 14.067387559112658, 13.909768460414908, 13.741863418446117, 13.56500314664371, 13.380480218899738, 13.18954906956087, 12.993425993428406, 12.793289145758264, 12.793289145758264, 12.228895137510264, 11.664576379297461, 11.100332871119855, 10.536164612977448, 9.972071604870237, 9.408053846798229, 8.844111338761412, 8.280244080759795, 7.716452072793375, 7.152735314862152, 6.589093806966131, 6.025527549105304, 5.462036541279675, 4.898620783489243, 4.335280275734009, 3.772015018013972, 3.208825010329134, 2.645710252679491, 2.0826707450650463, 1.519706487485804, 0.956817479941753, 0.3940037224329007, -0.168734785040753, -0.7313980424792081, -1.2939860498824647, -1.8564988072505262, -2.4189363145833926, -2.9812985718810534, -3.5435855791435227, -4.105797336370793, -4.667933843562869, -5.229995100719746, -5.7919811078414245, -6.353891864927908, -6.915727371979186, -7.477487628995268, -8.039172635976156, -8.600782392921849, -9.162316899832339, -9.723776156707638, -10.285160163547738, -10.84646892035264, -11.407702427122333, -11.96886068385684, -12.52994369055615, -13.090951447220261, -13.65188395384917, -14.212741210442884, -14.773523217001403, -14.773523217001403, -14.812828416887148, -14.855814779206815, -14.901476717054313, -14.948833219288561, -14.996927850533444, -15.044828751177851, -15.091628637375686, -15.136444801045867, -15.178419109872275, -15.216718007303795, -15.250532512554342, -15.279078220602807, -15.301595302193087, -15.317348503834063, -15.325627147799645, -15.325745132128718, -15.317040930625174, -15.298877592857908, -15.270642744160815 ]
sr_1x = [ 24.5781054412584, 23.582041705433518, 22.62019014210586, 21.692550751275416, 20.7991235329422, 19.9399084871062, 19.114905613767423, 18.32411491292587, 17.56753638458154, 16.845170028734426, 16.157015845384535, 15.503073834531868, 14.88334399617642, 14.297826330318195, 13.746520836957192, 13.22942751609341, 12.746546367726847, 12.297877391857504, 11.883420588485388, 11.503175957610491, 11.157143499232815, 10.84532321335236, 10.567715099969128, 10.324319159083114, 10.115135390694325, 9.940163794802757, 9.799404371408409, 9.692857120511285, 9.620522042111379, 9.582399136208696, 9.578488402803234, 9.608789841894994, 9.673303453483975, 9.772029237570178, 9.904967194153603, 10.072117323234249, 10.273479624812115, 10.509054098887201, 10.778840745459512, 11.082839564529042, 11.421050556095796, 11.79347372015977, 12.200109056720965, 12.640956565779383, 13.11601624733502, 13.62528810138788, 14.168772127937961, 14.746468326985266, 15.35837669852979, 16.004497242571535 ]
sr_1y = [ -15.183986186355112, -14.502280453589774, -13.82394660328635, -13.14898463544485, -12.477394550065261, -11.80917634714759, -11.144330026691838, -10.48285558869801, -9.824753033166095, -9.170022360096093, -8.51866356948801, -7.870676661341845, -7.226061635657599, -6.584818492435273, -5.94694723167486, -5.312447853376371, -4.681320357539795, -4.053564744165135, -3.429181013252391, -2.8081691648015674, -2.1905291988126585, -1.5762611152856696, -0.9653649142206024, -0.35784059561744463, 0.24631184052378963, 0.8470923942031092, 1.4445010654205088, 2.0385378541759938, 2.6292027604695605, 3.216495784301209, 3.8004169256709392, 4.380966184578753, 4.9581435610246505, 5.53194905500863, 6.102382666530691, 6.669444395590833, 7.23313424218906, 7.7934522063253695, 8.350398287999761, 8.903972487212233, 9.45417480396279, 10.001005238251429, 10.54446379007815, 11.084550459442957, 11.621265246345839, 12.15460815078681, 12.684579172765861, 13.211178312282996, 13.734405569338213, 14.254260943931513 ]
sr_2x = [ -5.421894558741599, -6.417958294566482, -7.379809857894143, -8.307449248724582, -9.200876467057801, -10.060091512893798, -10.885094386232575, -11.675885087074128, -12.432463615418461, -13.154829971265572, -13.842984154615465, -14.496926165468132, -15.11665600382358, -15.702173669681805, -16.253479163042808, -16.77057248390659, -17.253453632273153, -17.702122608142496, -18.11657941151461, -18.49682404238951, -18.842856500767187, -19.154676786647638, -19.432284900030872, -19.675680840916886, -19.884864609305676, -20.059836205197243, -20.20059562859159, -20.307142879488715, -20.37947795788862, -20.417600863791304, -20.421511597196766, -20.391210158105007, -20.326696546516025, -20.227970762429823, -20.095032805846397, -19.92788267676575, -19.726520375187885, -19.4909459011128, -19.22115925454049, -18.917160435470958, -18.578949443904204, -18.20652627984023, -17.799890943279035, -17.359043434220617, -16.88398375266498, -16.37471189861212, -15.831227872062039, -15.253531673014734, -14.64162330147021, -13.995502757428465 ]
sr_2y = [ -15.183986186355112, -14.502280453589774, -13.82394660328635, -13.14898463544485, -12.477394550065261, -11.80917634714759, -11.144330026691838, -10.48285558869801, -9.824753033166095, -9.170022360096093, -8.51866356948801, -7.870676661341845, -7.226061635657599, -6.584818492435273, -5.94694723167486, -5.312447853376371, -4.681320357539795, -4.053564744165135, -3.429181013252391, -2.8081691648015674, -2.1905291988126585, -1.5762611152856696, -0.9653649142206024, -0.35784059561744463, 0.24631184052378963, 0.8470923942031092, 1.4445010654205088, 2.0385378541759938, 2.6292027604695605, 3.216495784301209, 3.8004169256709392, 4.380966184578753, 4.9581435610246505, 5.53194905500863, 6.102382666530691, 6.669444395590833, 7.23313424218906, 7.7934522063253695, 8.350398287999761, 8.903972487212233, 9.45417480396279, 10.001005238251429, 10.54446379007815, 11.084550459442957, 11.621265246345839, 12.15460815078681, 12.684579172765861, 13.211178312282996, 13.734405569338213, 14.254260943931513 ]

for i in range(len(x_array)):
    try:
        if i < len(x_array):
            Sketch.addGeometry(
                Part.LineSegment(
                    App.Vector(x_array[i], y_array[i], 0),
                    App.Vector(x_array[i + 1], y_array[i + 1], 0)
                ),
                False
            )
        else:
            pass
    except Exception:
        pass


for i in range(len(sr_1x)):
    try:
        if i < len(sr_1x):
            Sketch.addGeometry(
                Part.LineSegment(
                    App.Vector(sr_1x[i], sr_1y[i], 0),
                    App.Vector(sr_1x[i + 1], sr_1y[i + 1], 0)
                ),
                False
            )
        else:
            pass
    except Exception:
        pass


for i in range(len(sr_2x)):
    try:
        if i < len(sr_2x):
            Sketch.addGeometry(
                Part.LineSegment(
                    App.Vector(sr_2x[i], sr_2y[i], 0),
                    App.Vector(sr_2x[i + 1], sr_2y[i + 1], 0)
                ),
                False
            )
        else:
            pass
    except Exception:
        pass


Sketch.addGeometry(
    Part.LineSegment(
        App.Vector(sr_2x[0], sr_2y[0], 0),
        App.Vector(sr_2x[0], sr_2y[0]-11, 0)
    ),
    False
)

Sketch.addGeometry(
    Part.LineSegment(
        App.Vector(sr_2x[-1], sr_2y[-1], 0),
        App.Vector(sr_2x[-1], sr_2y[-1]+11, 0)
    ),
    False
)
Sketch.addGeometry(
    Part.LineSegment(
        App.Vector(sr_1x[0], sr_1y[0], 0),
        App.Vector(sr_1x[0], sr_1y[0]-11, 0)
    ),
    False
)

Sketch.addGeometry(
    Part.LineSegment(
        App.Vector(sr_1x[-1], sr_1y[-1], 0),
        App.Vector(sr_1x[-1], sr_1y[-1]+11, 0)
    ),
    False
)

# Замыкаем контур
Sketch.addGeometry(
    Part.LineSegment(
        App.Vector(sr_1x[-1], sr_1y[-1]+11, 0),
        App.Vector(sr_2x[-1], sr_2y[-1]+11, 0)
    ),
    False
)
# Замыкаем контур
Sketch.addGeometry(
    Part.LineSegment(
        App.Vector(sr_1x[0], sr_1y[0]-11, 0),
        App.Vector(sr_2x[0], sr_2y[0]-11, 0)
    ),
    False
)

App.getDocument('Unnamed').recompute()

f = FreeCAD.getDocument('Unnamed').addObject('Part::Extrusion', 'Extrude')
f = App.getDocument('Unnamed').getObject('Extrude')
f.Base = App.getDocument('Unnamed').getObject('Sketch')
f.DirMode = "Custom"
f.Dir = App.Vector(0.000000000000000, 0.000000000000000, 1.000000000000000)
f.DirLink = None
f.LengthFwd = 4.500000000000000
f.LengthRev = 0.000000000000000
f.Solid = True
f.Reversed = False
f.Symmetric = False
f.TaperAngle = 0.000000000000000
f.TaperAngleRev = 0.000000000000000
# Gui.ActiveDocument.Extrude.ShapeColor=Gui.ActiveDocument.Sketch.ShapeColor
# Gui.ActiveDocument.Extrude.LineColor=Gui.ActiveDocument.Sketch.LineColor
# Gui.ActiveDocument.Extrude.PointColor=Gui.ActiveDocument.Sketch.PointColor
# f.Base.ViewObject.hide()

doc.recompute()

__objs__=[]
__objs__.append(FreeCAD.getDocument("Unnamed").getObject("Extrude"))
import Import
Import.export(__objs__, u"C:/Users/asea2/Desktop/"
                           u"PycharmProjects/Prikolno/freecadfiles/imyafila.step")

del __objs__

